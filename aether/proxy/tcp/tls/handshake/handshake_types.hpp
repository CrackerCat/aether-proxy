#pragma once

#include <aether/proxy/types.hpp>

namespace proxy::tcp::tls::handshake {
    enum class extension_type : double_byte {
        server_name = 0x0000,
        max_fragment_length = 0x0001,
        client_certificate_url = 0x0002,
        trusted_ca_keys = 0x0003,
        truncated_hmac = 0x0004,
        status_request = 0x0005,
        user_mapping = 0x0006,
        client_authz = 0x0007,
        server_authz = 0x0008,
        cert_type = 0x0009,
        supported_groups = 0x000A,
        ec_point_formats = 0x000B,
        srp = 0x000C,
        signature_algorithms = 0x000D,
        use_srtp = 0x000E,
        heartbeat = 0x000F,
        application_layer_protocol_negotiation = 0x0010,
        status_request_v2 = 0x0011,
        signed_certificate_timestamp = 0x0012,
        client_certificate_type = 0x0013,
        server_certificate_type = 0x0014,
        padding = 0x0015,
        encrypt_then_mac = 0x0016,
        extended_master_secret = 0x0017,
        token_binding = 0x0018,
        cached_info = 0x0019,
        tls_lts = 0x001A,
        compress_certificate = 0x001B,
        record_size_limit = 0x001C,
        pwd_protect = 0x001D,
        pwd_clear = 0x001E,
        password_salt = 0x001F,
        ticket_pinning = 0x0020,
        tls_cert_with_extern_psk = 0x0021,
        delegated_credentials = 0x0022,
        session_ticket = 0x0023,
        pre_shared_key = 0x0029,
        early_data = 0x002A,
        supported_versions = 0x002B,
        cookie = 0x002C,
        psk_key_exchange_modes = 0x002D,
        certificate_authorities = 0x002F,
        oid_filters = 0x0030,
        post_handshake_auth = 0x0031,
        signature_algorithms_cert = 0x0032,
        key_share = 0x0033,
        transparency_info = 0x0034,
        external_id_hash = 0x0037,
        external_session_id = 0x0038
    };

    /*
        let seen = new Map();
        let list = [];
        document.querySelectorAll('tbody tr').forEach(tr => {
            let cols = tr.querySelectorAll('td');
            if (cols.length > 1) {
                let name = cols[1].innerText;
                if (name) {
                    name = name.replace(/-/g, '_');
                    if (name === 'NULL') {
                        name = '_NULL';
                    }
                    let val = seen.get(name);
                    val = val === undefined ? 0 : val;
                    let enumName = name;
                    if (val > 0) {
                        enumName += `__${val}`;
                    }
                    seen.set(name, val + 1);
                    let id = cols[0].innerText;
                    id = id.substring(1, id.length - 1);
                    list.push(`${enumName} = ${id}`);
                }
            }
        });
        list.join(',\n');
    */

    // Taken from https://testssl.sh/openssl-iana.mapping.html
    enum class cipher_suite_name {
        NULL_MD5 = 0x01,
        NULL_SHA = 0x02,
        EXP_RC4_MD5 = 0x03,
        RC4_MD5 = 0x04,
        RC4_SHA = 0x05,
        EXP_RC2_CBC_MD5 = 0x06,
        IDEA_CBC_SHA = 0x07,
        EXP_DES_CBC_SHA = 0x08,
        DES_CBC_SHA = 0x09,
        DES_CBC3_SHA = 0x0a,
        EXP_DH_DSS_DES_CBC_SHA = 0x0b,
        DH_DSS_DES_CBC_SHA = 0x0c,
        DH_DSS_DES_CBC3_SHA = 0x0d,
        EXP_DH_RSA_DES_CBC_SHA = 0x0e,
        DH_RSA_DES_CBC_SHA = 0x0f,
        DH_RSA_DES_CBC3_SHA = 0x10,
        EXP_EDH_DSS_DES_CBC_SHA = 0x11,
        EDH_DSS_DES_CBC_SHA = 0x12,
        EDH_DSS_DES_CBC3_SHA = 0x13,
        EXP_EDH_RSA_DES_CBC_SHA = 0x14,
        EDH_RSA_DES_CBC_SHA = 0x15,
        EDH_RSA_DES_CBC3_SHA = 0x16,
        EXP_ADH_RC4_MD5 = 0x17,
        ADH_RC4_MD5 = 0x18,
        EXP_ADH_DES_CBC_SHA = 0x19,
        ADH_DES_CBC_SHA = 0x1a,
        ADH_DES_CBC3_SHA = 0x1b,
        KRB5_DES_CBC_SHA = 0x1e,
        KRB5_DES_CBC3_SHA = 0x1f,
        KRB5_RC4_SHA = 0x20,
        KRB5_IDEA_CBC_SHA = 0x21,
        KRB5_DES_CBC_MD5 = 0x22,
        KRB5_DES_CBC3_MD5 = 0x23,
        KRB5_RC4_MD5 = 0x24,
        KRB5_IDEA_CBC_MD5 = 0x25,
        EXP_KRB5_DES_CBC_SHA = 0x26,
        EXP_KRB5_RC2_CBC_SHA = 0x27,
        EXP_KRB5_RC4_SHA = 0x28,
        EXP_KRB5_DES_CBC_MD5 = 0x29,
        EXP_KRB5_RC2_CBC_MD5 = 0x2a,
        EXP_KRB5_RC4_MD5 = 0x2b,
        PSK_NULL_SHA = 0x2c,
        DHE_PSK_NULL_SHA = 0x2d,
        RSA_PSK_NULL_SHA = 0x2e,
        AES128_SHA = 0x2f,
        DH_DSS_AES128_SHA = 0x30,
        DH_RSA_AES128_SHA = 0x31,
        DHE_DSS_AES128_SHA = 0x32,
        DHE_RSA_AES128_SHA = 0x33,
        ADH_AES128_SHA = 0x34,
        AES256_SHA = 0x35,
        DH_DSS_AES256_SHA = 0x36,
        DH_RSA_AES256_SHA = 0x37,
        DHE_DSS_AES256_SHA = 0x38,
        DHE_RSA_AES256_SHA = 0x39,
        ADH_AES256_SHA = 0x3a,
        NULL_SHA256 = 0x3b,
        AES128_SHA256 = 0x3c,
        AES256_SHA256 = 0x3d,
        DH_DSS_AES128_SHA256 = 0x3e,
        DH_RSA_AES128_SHA256 = 0x3f,
        DHE_DSS_AES128_SHA256 = 0x40,
        CAMELLIA128_SHA = 0x41,
        DH_DSS_CAMELLIA128_SHA = 0x42,
        DH_RSA_CAMELLIA128_SHA = 0x43,
        DHE_DSS_CAMELLIA128_SHA = 0x44,
        DHE_RSA_CAMELLIA128_SHA = 0x45,
        ADH_CAMELLIA128_SHA = 0x46,
        EXP1024_RC4_MD5 = 0x60,
        EXP1024_RC2_CBC_MD5 = 0x61,
        EXP1024_DES_CBC_SHA = 0x62,
        EXP1024_DHE_DSS_DES_CBC_SHA = 0x63,
        EXP1024_RC4_SHA = 0x64,
        EXP1024_DHE_DSS_RC4_SHA = 0x65,
        DHE_DSS_RC4_SHA = 0x66,
        DHE_RSA_AES128_SHA256 = 0x67,
        DH_DSS_AES256_SHA256 = 0x68,
        DH_RSA_AES256_SHA256 = 0x69,
        DHE_DSS_AES256_SHA256 = 0x6a,
        DHE_RSA_AES256_SHA256 = 0x6b,
        ADH_AES128_SHA256 = 0x6c,
        ADH_AES256_SHA256 = 0x6d,
        GOST94_GOST89_GOST89 = 0x80,
        GOST2001_GOST89_GOST89 = 0x81,
        GOST94_NULL_GOST94 = 0x82,
        GOST2001_GOST89_GOST89__1 = 0x83,
        CAMELLIA256_SHA = 0x84,
        DH_DSS_CAMELLIA256_SHA = 0x85,
        DH_RSA_CAMELLIA256_SHA = 0x86,
        DHE_DSS_CAMELLIA256_SHA = 0x87,
        DHE_RSA_CAMELLIA256_SHA = 0x88,
        ADH_CAMELLIA256_SHA = 0x89,
        PSK_RC4_SHA = 0x8a,
        PSK_3DES_EDE_CBC_SHA = 0x8b,
        PSK_AES128_CBC_SHA = 0x8c,
        PSK_AES256_CBC_SHA = 0x8d,
        SEED_SHA = 0x96,
        DH_DSS_SEED_SHA = 0x97,
        DH_RSA_SEED_SHA = 0x98,
        DHE_DSS_SEED_SHA = 0x99,
        DHE_RSA_SEED_SHA = 0x9a,
        ADH_SEED_SHA = 0x9b,
        AES128_GCM_SHA256 = 0x9c,
        AES256_GCM_SHA384 = 0x9d,
        DHE_RSA_AES128_GCM_SHA256 = 0x9e,
        DHE_RSA_AES256_GCM_SHA384 = 0x9f,
        DH_RSA_AES128_GCM_SHA256 = 0xa0,
        DH_RSA_AES256_GCM_SHA384 = 0xa1,
        DHE_DSS_AES128_GCM_SHA256 = 0xa2,
        DHE_DSS_AES256_GCM_SHA384 = 0xa3,
        DH_DSS_AES128_GCM_SHA256 = 0xa4,
        DH_DSS_AES256_GCM_SHA384 = 0xa5,
        ADH_AES128_GCM_SHA256 = 0xa6,
        ADH_AES256_GCM_SHA384 = 0xa7,
        CAMELLIA128_SHA256 = 0xba,
        DH_DSS_CAMELLIA128_SHA256 = 0xbb,
        DH_RSA_CAMELLIA128_SHA256 = 0xbc,
        DHE_DSS_CAMELLIA128_SHA256 = 0xbd,
        DHE_RSA_CAMELLIA128_SHA256 = 0xbe,
        ADH_CAMELLIA128_SHA256 = 0xbf,
        TLS_FALLBACK_SCSV = 0x5600,
        TLS_AES_128_GCM_SHA256 = 0x1301,
        TLS_AES_256_GCM_SHA384 = 0x1302,
        TLS_CHACHA20_POLY1305_SHA256 = 0x1303,
        TLS_AES_128_CCM_SHA256 = 0x1304,
        TLS_AES_128_CCM_8_SHA256 = 0x1305,
        ECDH_ECDSA_NULL_SHA = 0xc001,
        ECDH_ECDSA_RC4_SHA = 0xc002,
        ECDH_ECDSA_DES_CBC3_SHA = 0xc003,
        ECDH_ECDSA_AES128_SHA = 0xc004,
        ECDH_ECDSA_AES256_SHA = 0xc005,
        ECDHE_ECDSA_NULL_SHA = 0xc006,
        ECDHE_ECDSA_RC4_SHA = 0xc007,
        ECDHE_ECDSA_DES_CBC3_SHA = 0xc008,
        ECDHE_ECDSA_AES128_SHA = 0xc009,
        ECDHE_ECDSA_AES256_SHA = 0xc00a,
        ECDH_RSA_NULL_SHA = 0xc00b,
        ECDH_RSA_RC4_SHA = 0xc00c,
        ECDH_RSA_DES_CBC3_SHA = 0xc00d,
        ECDH_RSA_AES128_SHA = 0xc00e,
        ECDH_RSA_AES256_SHA = 0xc00f,
        ECDHE_RSA_NULL_SHA = 0xc010,
        ECDHE_RSA_RC4_SHA = 0xc011,
        ECDHE_RSA_DES_CBC3_SHA = 0xc012,
        ECDHE_RSA_AES128_SHA = 0xc013,
        ECDHE_RSA_AES256_SHA = 0xc014,
        AECDH_NULL_SHA = 0xc015,
        AECDH_RC4_SHA = 0xc016,
        AECDH_DES_CBC3_SHA = 0xc017,
        AECDH_AES128_SHA = 0xc018,
        AECDH_AES256_SHA = 0xc019,
        SRP_3DES_EDE_CBC_SHA = 0xc01a,
        SRP_RSA_3DES_EDE_CBC_SHA = 0xc01b,
        SRP_DSS_3DES_EDE_CBC_SHA = 0xc01c,
        SRP_AES_128_CBC_SHA = 0xc01d,
        SRP_RSA_AES_128_CBC_SHA = 0xc01e,
        SRP_DSS_AES_128_CBC_SHA = 0xc01f,
        SRP_AES_256_CBC_SHA = 0xc020,
        SRP_RSA_AES_256_CBC_SHA = 0xc021,
        SRP_DSS_AES_256_CBC_SHA = 0xc022,
        ECDHE_ECDSA_AES128_SHA256 = 0xc023,
        ECDHE_ECDSA_AES256_SHA384 = 0xc024,
        ECDH_ECDSA_AES128_SHA256 = 0xc025,
        ECDH_ECDSA_AES256_SHA384 = 0xc026,
        ECDHE_RSA_AES128_SHA256 = 0xc027,
        ECDHE_RSA_AES256_SHA384 = 0xc028,
        ECDH_RSA_AES128_SHA256 = 0xc029,
        ECDH_RSA_AES256_SHA384 = 0xc02a,
        ECDHE_ECDSA_AES128_GCM_SHA256 = 0xc02b,
        ECDHE_ECDSA_AES256_GCM_SHA384 = 0xc02c,
        ECDH_ECDSA_AES128_GCM_SHA256 = 0xc02d,
        ECDH_ECDSA_AES256_GCM_SHA384 = 0xc02e,
        ECDHE_RSA_AES128_GCM_SHA256 = 0xc02f,
        ECDHE_RSA_AES256_GCM_SHA384 = 0xc030,
        ECDH_RSA_AES128_GCM_SHA256 = 0xc031,
        ECDH_RSA_AES256_GCM_SHA384 = 0xc032,
        ECDHE_PSK_RC4_SHA = 0xc033,
        ECDHE_PSK_3DES_EDE_CBC_SHA = 0xc034,
        ECDHE_PSK_AES128_CBC_SHA = 0xc035,
        ECDHE_PSK_AES256_CBC_SHA = 0xc036,
        ECDHE_PSK_AES128_CBC_SHA256 = 0xc037,
        ECDHE_PSK_AES256_CBC_SHA384 = 0xc038,
        ECDHE_PSK_NULL_SHA = 0xc039,
        ECDHE_PSK_NULL_SHA256 = 0xc03A,
        ECDHE_PSK_NULL_SHA384 = 0xc03B,
        ECDHE_ECDSA_CAMELLIA128_SHA256 = 0xc072,
        ECDHE_ECDSA_CAMELLIA256_SHA38 = 0xc073,
        ECDH_ECDSA_CAMELLIA128_SHA256 = 0xc074,
        ECDH_ECDSA_CAMELLIA256_SHA384 = 0xc075,
        ECDHE_RSA_CAMELLIA128_SHA256 = 0xc076,
        ECDHE_RSA_CAMELLIA256_SHA384 = 0xc077,
        ECDH_RSA_CAMELLIA128_SHA256 = 0xc078,
        ECDH_RSA_CAMELLIA256_SHA384 = 0xc079,
        PSK_CAMELLIA128_SHA256 = 0xc094,
        PSK_CAMELLIA256_SHA384 = 0xc095,
        DHE_PSK_CAMELLIA128_SHA256 = 0xc096,
        DHE_PSK_CAMELLIA256_SHA384 = 0xc097,
        RSA_PSK_CAMELLIA128_SHA256 = 0xc098,
        RSA_PSK_CAMELLIA256_SHA384 = 0xc099,
        ECDHE_PSK_CAMELLIA128_SHA25 = 0xc09A,
        ECDHE_PSK_CAMELLIA256_SHA38 = 0xc09B,
        AES128_CCM = 0xc09c,
        AES256_CCM = 0xc09d,
        DHE_RSA_AES128_CCM = 0xc09e,
        DHE_RSA_AES256_CCM = 0xc09f,
        AES128_CCM8 = 0xc0a0,
        AES256_CCM8 = 0xc0a1,
        DHE_RSA_AES128_CCM8 = 0xc0a2,
        DHE_RSA_AES256_CCM8 = 0xc0a3,
        PSK_AES128_CCM = 0xc0a4,
        PSK_AES256_CCM = 0xc0a5,
        DHE_PSK_AES128_CCM = 0xc0a6,
        DHE_PSK_AES256_CCM = 0xc0a7,
        PSK_AES128_CCM8 = 0xc0a8,
        PSK_AES256_CCM8 = 0xc0a9,
        DHE_PSK_AES128_CCM8 = 0xc0aa,
        DHE_PSK_AES256_CCM8 = 0xc0ab,
        ECDHE_ECDSA_AES128_CCM = 0xc0ac,
        ECDHE_ECDSA_AES256_CCM = 0xc0ad,
        ECDHE_ECDSA_AES128_CCM8 = 0xc0ae,
        ECDHE_ECDSA_AES256_CCM8 = 0xc0af,
        ECDHE_RSA_CHACHA20_POLY1305_OLD = 0xcc13,
        ECDHE_ECDSA_CHACHA20_POLY1305_OLD = 0xcc14,
        DHE_RSA_CHACHA20_POLY1305_OLD = 0xcc15,
        GOST_MD5 = 0xff00,
        GOST_GOST94 = 0xff01,
        GOST_GOST89MAC = 0xff02,
        GOST_GOST89STREAM = 0xff03,
        RC4_MD5__1 = 0x010080,
        EXP_RC4_MD5__1 = 0x020080,
        RC2_CBC_MD5 = 0x030080,
        EXP_RC2_CBC_MD5__1 = 0x040080,
        IDEA_CBC_MD5 = 0x050080,
        DES_CBC_MD5 = 0x060040,
        DES_CBC_SHA__1 = 0x060140,
        DES_CBC3_MD5 = 0x0700c0,
        DES_CBC3_SHA__1 = 0x0701c0,
        RC4_64_MD5 = 0x080080,
        DES_CFB_M1 = 0xff0800,
        _NULL = 0xff0810
    };
}